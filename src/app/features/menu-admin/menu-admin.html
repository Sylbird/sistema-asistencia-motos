<div class="menu-admin-container">
  @if (loading()) {
    <div class="loading-overlay">
      <mat-spinner diameter="50"></mat-spinner>
      <p>Cargando datos...</p>
    </div>
  }

  <div class="cards-container">
    <!-- Conductores Card -->
    <mat-card class="usuarios-card">
      <mat-card-header>
        <div mat-card-avatar class="card-header-icon conductores-icon">
          <mat-icon>drive_eta</mat-icon>
        </div>
        <mat-card-title>Conductores</mat-card-title>
        <mat-card-subtitle>
          @if (conductores().length > 0) {
            {{ conductores().length }} conductor{{ conductores().length !== 1 ? 'es' : '' }}
          } @else {
            Sin registros
          }
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        @if (conductores().length === 0) {
          <div class="empty-state">
            <mat-icon class="empty-icon">inbox</mat-icon>
            <p class="empty-text">No hay conductores registrados</p>
          </div>
        } @else {
          <div class="table-container">
            <table mat-table [dataSource]="conductores()" class="usuarios-table">
              <!-- Nombre Completo Column -->
              <ng-container matColumnDef="nombreCompleto">
                <th mat-header-cell *matHeaderCellDef>Nombre Completo</th>
                <td mat-cell *matCellDef="let usuario">
                  <div class="user-cell">
                    <mat-icon class="cell-icon">person</mat-icon>
                    <span>{{ getNombreCompleto(usuario) }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Correo Column -->
              <ng-container matColumnDef="correo">
                <th mat-header-cell *matHeaderCellDef>Correo</th>
                <td mat-cell *matCellDef="let usuario">
                  <div class="email-cell">
                    <mat-icon class="cell-icon">email</mat-icon>
                    <span>{{ usuario.correo }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Rol Column -->

              <ng-container matColumnDef="rol">
                <th mat-header-cell *matHeaderCellDef>Rol</th>
                <td mat-cell *matCellDef="let usuario">
                  <div class="rol-cell">
                    <span
                      class="rol-badge"
                      [class.admin]="usuario.id_rol === 1"
                      [class.conductor]="usuario.id_rol === 2"
                    >
                      {{ getRoleName(usuario.id_rol) }}
                    </span>
                  </div>
                </td>
              </ng-container>

              <!-- Teléfono Column -->

              <ng-container matColumnDef="telefono">
                <th mat-header-cell *matHeaderCellDef>Teléfono</th>
                <td mat-cell *matCellDef="let usuario">
                  <div class="phone-cell">
                    <mat-icon class="cell-icon">phone</mat-icon>
                    <span>{{ usuario.telefono }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Acciones Column -->
              <ng-container matColumnDef="acciones">
                <th mat-header-cell *matHeaderCellDef>Acciones</th>
                <td mat-cell *matCellDef="let usuario">
                  <div class="actions-cell">
                    <button
                      mat-icon-button
                      color="primary"
                      (click)="openEditDialog(usuario)"
                      matTooltip="Editar"
                    >
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button
                      mat-icon-button
                      color="warn"
                      (click)="deleteUsuario(usuario)"
                      matTooltip="Eliminar (próximamente)"
                      disabled
                    >
                      <mat-icon>delete</mat-icon>
                    </button>
                  </div>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
          </div>
        }
      </mat-card-content>
    </mat-card>

    <!-- Admins Card -->
    <mat-card class="usuarios-card">
      <mat-card-header>
        <div mat-card-avatar class="card-header-icon admins-icon">
          <mat-icon>admin_panel_settings</mat-icon>
        </div>
        <mat-card-title>Administradores</mat-card-title>
        <mat-card-subtitle>
          @if (admins().length > 0) {
            {{ admins().length }} administrador{{ admins().length !== 1 ? 'es' : '' }}
          } @else {
            Sin registros
          }
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        @if (admins().length === 0) {
          <div class="empty-state">
            <mat-icon class="empty-icon">inbox</mat-icon>
            <p class="empty-text">No hay administradores registrados</p>
          </div>
        } @else {
          <div class="table-container">
            <table mat-table [dataSource]="admins()" class="usuarios-table">
              <!-- Nombre Completo Column -->
              <ng-container matColumnDef="nombreCompleto">
                <th mat-header-cell *matHeaderCellDef>Nombre Completo</th>
                <td mat-cell *matCellDef="let usuario">
                  <div class="user-cell">
                    <mat-icon class="cell-icon">person</mat-icon>
                    <span>{{ getNombreCompleto(usuario) }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Correo Column -->
              <ng-container matColumnDef="correo">
                <th mat-header-cell *matHeaderCellDef>Correo</th>
                <td mat-cell *matCellDef="let usuario">
                  <div class="email-cell">
                    <mat-icon class="cell-icon">email</mat-icon>
                    <span>{{ usuario.correo }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Rol Column -->
              <ng-container matColumnDef="rol">
                <th mat-header-cell *matHeaderCellDef>Rol</th>
                <td mat-cell *matCellDef="let usuario">
                  <div class="rol-cell">
                    <span
                      class="rol-badge"
                      [class.admin]="usuario.id_rol === 1"
                      [class.conductor]="usuario.id_rol === 2"
                    >
                      {{ getRoleName(usuario.id_rol) }}
                    </span>
                  </div>
                </td>
              </ng-container>

              <!-- Teléfono Column -->
              <ng-container matColumnDef="telefono">
                <th mat-header-cell *matHeaderCellDef>Teléfono</th>
                <td mat-cell *matCellDef="let usuario">
                  <div class="phone-cell">
                    <mat-icon class="cell-icon">phone</mat-icon>
                    <span>{{ usuario.telefono }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Acciones Column -->
              <ng-container matColumnDef="acciones">
                <th mat-header-cell *matHeaderCellDef>Acciones</th>
                <td mat-cell *matCellDef="let usuario">
                  <div class="actions-cell">
                    <button
                      mat-icon-button
                      color="primary"
                      (click)="openEditDialog(usuario)"
                      matTooltip="Editar"
                    >
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button
                      mat-icon-button
                      color="warn"
                      (click)="deleteUsuario(usuario)"
                      matTooltip="Eliminar (próximamente)"
                      disabled
                    >
                      <mat-icon>delete</mat-icon>
                    </button>
                  </div>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
          </div>
        }
      </mat-card-content>
    </mat-card>
  </div>
</div>
